<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flowing Background</title>
    <style>
        .flowing-background {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .flow-layer {
            position: absolute;
            width: 100%;
            height: 130vh;
            will-change: transform, opacity;
        }

        .diagonal-line {
            position: absolute;
            background: linear-gradient(to right, transparent, var(--line-color), transparent);
            will-change: transform, opacity;
        }

        .geometric-shape {
            position: absolute;
            will-change: transform, opacity;
        }

        .parallelogram {
            clip-path: polygon(15% 0%, 100% 0%, 85% 100%, 0% 100%);
        }

        .pentagon {
            clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
        }

        .slanted-rect {
            clip-path: polygon(25% 0%, 100% 0%, 75% 100%, 0% 100%);
        }

        .diamond {
            clip-path: polygon(0% 25%, 75% 0%, 100% 75%, 25% 100%);
        }

        .chevron-shape {
            clip-path: polygon(0% 20%, 90% 0%, 100% 80%, 10% 100%);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(var(--rotation)); }
            50% { transform: translateY(-10px) rotate(var(--rotation)); }
        }

        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="flowing-background" class="flowing-background">
        <!-- Primary Diagonal Stripes - Left to Right -->
        <div class="flow-layer" data-speed="-300" data-opacity="0.1,0.25,0.2,0.1">
            <div class="diagonal-line" style="--line-color: #1662a9; left: -10%; top: 5%; width: 80%; height: 4px; transform: rotate(25deg); opacity: 0.3;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 15%; top: 23%; width: 80%; height: 4px; transform: rotate(25deg); opacity: 0.26;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 40%; top: 41%; width: 80%; height: 4px; transform: rotate(25deg); opacity: 0.22;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 65%; top: 59%; width: 80%; height: 4px; transform: rotate(25deg); opacity: 0.18;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 90%; top: 77%; width: 80%; height: 4px; transform: rotate(25deg); opacity: 0.14;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 115%; top: 95%; width: 80%; height: 4px; transform: rotate(25deg); opacity: 0.1;"></div>
        </div>

        <!-- Secondary Diagonal Stripes - Right to Left -->
        <div class="flow-layer" data-speed="-400" data-opacity="0.15,0.3,0.25,0.15">
            <div class="diagonal-line" style="--line-color: #4a9eff; right: -15%; top: 15%; width: 70%; height: 2px; transform: rotate(-20deg); opacity: 0.25;"></div>
            <div class="diagonal-line" style="--line-color: #4a9eff; right: 13%; top: 35%; width: 70%; height: 2px; transform: rotate(-20deg); opacity: 0.22;"></div>
            <div class="diagonal-line" style="--line-color: #4a9eff; right: 41%; top: 55%; width: 70%; height: 2px; transform: rotate(-20deg); opacity: 0.19;"></div>
            <div class="diagonal-line" style="--line-color: #4a9eff; right: 69%; top: 75%; width: 70%; height: 2px; transform: rotate(-20deg); opacity: 0.16;"></div>
            <div class="diagonal-line" style="--line-color: #4a9eff; right: 97%; top: 95%; width: 70%; height: 2px; transform: rotate(-20deg); opacity: 0.13;"></div>
        </div>

        <!-- Downward Diagonal Flow Lines -->
        <div class="flow-layer" data-speed="-250" data-opacity="0.08,0.2,0.18,0.08">
            <div class="diagonal-line" style="background: linear-gradient(to right, #1662a9, #4a9eff, transparent); left: 10%; top: 20%; width: 60%; height: 6px; transform: rotate(35deg); opacity: 0.2;"></div>
            <div class="diagonal-line" style="background: linear-gradient(to right, #1662a9, #4a9eff, transparent); left: 40%; top: 45%; width: 60%; height: 6px; transform: rotate(35deg); opacity: 0.17;"></div>
            <div class="diagonal-line" style="background: linear-gradient(to right, #1662a9, #4a9eff, transparent); left: 70%; top: 70%; width: 60%; height: 6px; transform: rotate(35deg); opacity: 0.14;"></div>
            <div class="diagonal-line" style="background: linear-gradient(to right, #1662a9, #4a9eff, transparent); left: 100%; top: 95%; width: 60%; height: 6px; transform: rotate(35deg); opacity: 0.11;"></div>
        </div>

        <!-- Diagonal Cascade Pattern -->
        <div class="flow-layer" data-speed="-280" data-opacity="0.05,0.18,0.15,0.05">
            <div class="geometric-shape parallelogram" style="left: 5%; top: 10%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.18), rgba(74, 158, 255, 0.12)); transform: rotate(15deg);"></div>
            <div class="geometric-shape parallelogram" style="left: 20%; top: 25%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.16), rgba(74, 158, 255, 0.105)); transform: rotate(17deg);"></div>
            <div class="geometric-shape parallelogram" style="left: 35%; top: 40%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.14), rgba(74, 158, 255, 0.09)); transform: rotate(19deg);"></div>
            <div class="geometric-shape parallelogram" style="left: 50%; top: 55%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.12), rgba(74, 158, 255, 0.075)); transform: rotate(21deg);"></div>
            <div class="geometric-shape parallelogram" style="left: 65%; top: 70%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.10), rgba(74, 158, 255, 0.06)); transform: rotate(23deg);"></div>
            <div class="geometric-shape parallelogram" style="left: 80%; top: 85%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.08), rgba(74, 158, 255, 0.045)); transform: rotate(25deg);"></div>
            <div class="geometric-shape parallelogram" style="left: 95%; top: 100%; width: 100px; height: 3px; background: linear-gradient(to right, rgba(22, 98, 169, 0.06), rgba(74, 158, 255, 0.03)); transform: rotate(27deg);"></div>
        </div>

        <!-- Strong Diagonal Visual Flow -->
        <div class="flow-layer" data-speed="-320" data-opacity="0.12,0.28,0.24,0.12">
            <div class="diagonal-line" style="background: linear-gradient(to right, transparent, #1662a9, #4a9eff); left: 15%; top: 25%; width: 50%; height: 8px; transform: rotate(30deg); opacity: 0.25;"></div>
            <div class="diagonal-line" style="background: linear-gradient(to right, transparent, #1662a9, #4a9eff); left: 50%; top: 55%; width: 50%; height: 8px; transform: rotate(30deg); opacity: 0.21;"></div>
            <div class="diagonal-line" style="background: linear-gradient(to right, transparent, #1662a9, #4a9eff); left: 85%; top: 85%; width: 50%; height: 8px; transform: rotate(30deg); opacity: 0.17;"></div>
        </div>

        <!-- Geometric Accent Elements -->
        <div class="flow-layer" data-speed="-350" data-opacity="0.1,0.22,0.25,0.1">
            <div class="geometric-shape parallelogram" style="left: 20%; top: 30%; width: 120px; height: 50px; background: linear-gradient(45deg, rgba(22, 98, 169, 0.12), rgba(74, 158, 255, 0.08)); border: 1px solid rgba(22, 98, 169, 0.15);"></div>
            <div class="geometric-shape parallelogram" style="left: 45%; top: 50%; width: 120px; height: 50px; background: linear-gradient(45deg, rgba(22, 98, 169, 0.10), rgba(74, 158, 255, 0.065)); border: 1px solid rgba(22, 98, 169, 0.12);"></div>
            <div class="geometric-shape parallelogram" style="left: 70%; top: 70%; width: 120px; height: 50px; background: linear-gradient(45deg, rgba(22, 98, 169, 0.08), rgba(74, 158, 255, 0.05)); border: 1px solid rgba(22, 98, 169, 0.09);"></div>
            <div class="geometric-shape parallelogram" style="left: 95%; top: 90%; width: 120px; height: 50px; background: linear-gradient(45deg, rgba(22, 98, 169, 0.06), rgba(74, 158, 255, 0.035)); border: 1px solid rgba(22, 98, 169, 0.06);"></div>
        </div>

        <!-- Angular Chevron Pattern -->
        <div class="flow-layer" data-speed="-260" data-opacity="0.08,0.2,0.22,0.08">
            <svg class="geometric-shape" style="left: 25%; top: 15%; width: 36px; height: 60px; transform: rotate(15deg);" viewBox="0 0 36 60">
                <defs>
                    <linearGradient id="angularChevronGradient0" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#1662a9" stop-opacity="0.25" />
                        <stop offset="50%" stop-color="#4a9eff" stop-opacity="0.18" />
                        <stop offset="100%" stop-color="#a5a5a5" stop-opacity="0.08" />
                    </linearGradient>
                </defs>
                <path d="M18 5 L28 20 L18 35 L8 20 Z" fill="url(#angularChevronGradient0)" fill-opacity="0.15" />
                <path d="M18 25 L28 40 L18 55 L8 40 Z" fill="url(#angularChevronGradient0)" fill-opacity="0.1" />
            </svg>
            <svg class="geometric-shape" style="left: 45%; top: 37%; width: 36px; height: 60px; transform: rotate(15deg);" viewBox="0 0 36 60">
                <defs>
                    <linearGradient id="angularChevronGradient1" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#1662a9" stop-opacity="0.25" />
                        <stop offset="50%" stop-color="#4a9eff" stop-opacity="0.18" />
                        <stop offset="100%" stop-color="#a5a5a5" stop-opacity="0.08" />
                    </linearGradient>
                </defs>
                <path d="M18 5 L28 20 L18 35 L8 20 Z" fill="url(#angularChevronGradient1)" fill-opacity="0.125" />
                <path d="M18 25 L28 40 L18 55 L8 40 Z" fill="url(#angularChevronGradient1)" fill-opacity="0.08" />
            </svg>
            <svg class="geometric-shape" style="left: 65%; top: 59%; width: 36px; height: 60px; transform: rotate(15deg);" viewBox="0 0 36 60">
                <defs>
                    <linearGradient id="angularChevronGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#1662a9" stop-opacity="0.25" />
                        <stop offset="50%" stop-color="#4a9eff" stop-opacity="0.18" />
                        <stop offset="100%" stop-color="#a5a5a5" stop-opacity="0.08" />
                    </linearGradient>
                </defs>
                <path d="M18 5 L28 20 L18 35 L8 20 Z" fill="url(#angularChevronGradient2)" fill-opacity="0.1" />
                <path d="M18 25 L28 40 L18 55 L8 40 Z" fill="url(#angularChevronGradient2)" fill-opacity="0.06" />
            </svg>
            <svg class="geometric-shape" style="left: 85%; top: 81%; width: 36px; height: 60px; transform: rotate(15deg);" viewBox="0 0 36 60">
                <defs>
                    <linearGradient id="angularChevronGradient3" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#1662a9" stop-opacity="0.25" />
                        <stop offset="50%" stop-color="#4a9eff" stop-opacity="0.18" />
                        <stop offset="100%" stop-color="#a5a5a5" stop-opacity="0.08" />
                    </linearGradient>
                </defs>
                <path d="M18 5 L28 20 L18 35 L8 20 Z" fill="url(#angularChevronGradient3)" fill-opacity="0.075" />
                <path d="M18 25 L28 40 L18 55 L8 40 Z" fill="url(#angularChevronGradient3)" fill-opacity="0.04" />
            </svg>
        </div>

        <!-- Diagonal Grid Pattern -->
        <div class="flow-layer" data-speed="-200" data-opacity="0.05,0.15,0.18,0.05">
            <div class="diagonal-line" style="--line-color: #1662a9; left: 0%; top: 40%; width: 25%; height: 2px; transform: rotate(45deg); opacity: 0.12;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 30%; top: 50%; width: 25%; height: 2px; transform: rotate(45deg); opacity: 0.10;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 60%; top: 60%; width: 25%; height: 2px; transform: rotate(45deg); opacity: 0.08;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 90%; top: 70%; width: 25%; height: 2px; transform: rotate(45deg); opacity: 0.06;"></div>
            <div class="diagonal-line" style="--line-color: #1662a9; left: 120%; top: 80%; width: 25%; height: 2px; transform: rotate(45deg); opacity: 0.04;"></div>
        </div>

        <!-- Stylish Geometric Accents -->
        <div class="geometric-shape slanted-rect animate-float" style="--rotation: 15deg; top: 16.67%; right: 20%; width: 64px; height: 128px; background: linear-gradient(135deg, rgba(22, 98, 169, 0.08) 0%, transparent 70%);" data-speed="-300" data-opacity="0,0.2,0"></div>
        <div class="geometric-shape diamond animate-float" style="--rotation: -20deg; top: 40%; left: 12.5%; width: 80px; height: 64px; background: linear-gradient(45deg, rgba(74, 158, 255, 0.1) 0%, transparent 60%);" data-speed="-220" data-opacity="0,0.18,0.2,0"></div>
        <div class="geometric-shape pentagon animate-float" style="--rotation: 25deg; top: 60%; right: 33.33%; width: 48px; height: 96px; background: linear-gradient(60deg, rgba(22, 98, 169, 0.06) 0%, transparent 80%);" data-speed="-180" data-opacity="0,0.15,0.18,0"></div>

        <!-- Subtle Connecting Diagonal Lines -->
        <div class="flow-layer" data-speed="-150" data-opacity="0.03,0.12,0.15,0.03">
            <div class="diagonal-line" style="--line-color: #4a9eff; left: 30%; top: 50%; width: 30%; height: 1px; transform: rotate(50deg); opacity: 0.1;"></div>
            <div class="diagonal-line" style="--line-color: #4a9eff; left: 55%; top: 65%; width: 30%; height: 1px; transform: rotate(50deg); opacity: 0.08;"></div>
            <div class="diagonal-line" style="--line-color: #4a9eff; left: 80%; top: 80%; width: 30%; height: 1px; transform: rotate(50deg); opacity: 0.06;"></div>
        </div>

        <!-- Final Diagonal Flow Elements -->
        <div class="flow-layer" data-speed="-380" data-opacity="0,0.2,0.16,0">
            <div class="geometric-shape chevron-shape" style="left: 40%; top: 60%; width: 35%; height: 12px; background: linear-gradient(to right, #1662a9, #4a9eff, transparent); transform: rotate(40deg); opacity: 0.15;"></div>
            <div class="geometric-shape chevron-shape" style="left: 80%; top: 80%; width: 35%; height: 12px; background: linear-gradient(to right, #1662a9, #4a9eff, transparent); transform: rotate(40deg); opacity: 0.12;"></div>
        </div>
    </div>

    <script>
        class FlowingBackground {
            constructor() {
                this.init();
            }

            init() {
                this.flowLayers = document.querySelectorAll('.flow-layer');
                this.geometricShapes = document.querySelectorAll('.geometric-shape[data-speed]');
                this.windowHeight = window.innerHeight;
                
                this.bindEvents();
                this.updateBackground();
            }

            bindEvents() {
                window.addEventListener('scroll', this.updateBackground.bind(this));
                window.addEventListener('resize', () => {
                    this.windowHeight = window.innerHeight;
                });
            }

            updateBackground() {
                const scrollPercent = window.pageYOffset / (document.documentElement.scrollHeight - this.windowHeight);
                const scrollProgress = Math.max(0, Math.min(1, scrollPercent));

                this.flowLayers.forEach(layer => {
                    const speed = parseFloat(layer.dataset.speed) || 0;
                    const opacityStops = layer.dataset.opacity ? layer.dataset.opacity.split(',').map(Number) : [0.1, 0.3, 0.2, 0.1];
                    
                    const translateY = scrollProgress * speed;
                    const opacity = this.interpolateOpacity(scrollProgress, opacityStops);
                    
                    layer.style.transform = `translateY(${translateY}px)`;
                    layer.style.opacity = opacity;
                });

                this.geometricShapes.forEach(shape => {
                    const speed = parseFloat(shape.dataset.speed) || 0;
                    const opacityStops = shape.dataset.opacity ? shape.dataset.opacity.split(',').map(Number) : [0, 0.2, 0];
                    
                    const translateY = scrollProgress * speed;
                    const opacity = this.interpolateOpacity(scrollProgress, opacityStops);
                    
                    const currentTransform = shape.style.transform || '';
                    const newTransform = currentTransform.replace(/translateY\([^)]*\)/, '') + ` translateY(${translateY}px)`;
                    
                    shape.style.transform = newTransform.trim();
                    shape.style.opacity = opacity;
                });
            }

            interpolateOpacity(progress, stops) {
                if (stops.length === 4) {
                    // [0, 0.2, 0.8, 1] keyframes
                    if (progress <= 0.2) {
                        return this.lerp(stops[0], stops[1], progress / 0.2);
                    } else if (progress <= 0.8) {
                        return this.lerp(stops[1], stops[2], (progress - 0.2) / 0.6);
                    } else {
                        return this.lerp(stops[2], stops[3], (progress - 0.8) / 0.2);
                    }
                } else if (stops.length === 3) {
                    // [0, 0.3, 1] keyframes
                    if (progress <= 0.3) {
                        return this.lerp(stops[0], stops[1], progress / 0.3);
                    } else {
                        return this.lerp(stops[1], stops[2], (progress - 0.3) / 0.7);
                    }
                }
                return stops[0] || 0.1;
            }

            lerp(start, end, t) {
                return start + (end - start) * t;
            }
        }

        // 全ページで使用できるようにグローバル関数として定義
        window.initFlowingBackground = function() {
            if (!window.flowingBackgroundInstance) {
                window.flowingBackgroundInstance = new FlowingBackground();
            }
        };

        // DOMContentLoadedで自動初期化
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', window.initFlowingBackground);
        } else {
            window.initFlowingBackground();
        }
    </script>
</body>
</html>